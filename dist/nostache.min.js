!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e=new Map,t=e=>{if(e&&"function"==typeof e.next){let o="",n=()=>new Promise((t=>t(e.next()))).then((e=>e.done?o:t(e.value).then((e=>o+=e)).then(n)));return n().then((()=>o))}return new Promise((t=>t(e)))},o=(n,i)=>{i=Object.assign(Object.assign({},o.options),i);const r=Object.assign(Object.assign({},o.options?o.options.extensions:void 0),i?i.extensions:void 0),c=e=>t(e).then("function"==typeof i.escape?i.escape:e=>null==e?"":String(e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`))),s=(t,n)=>(...r)=>{const c="string"==typeof t?t:t instanceof URL?t.toString():"";let s=c?e.get(c):void 0;return s&&"string"!=typeof s&&(s=void 0),o(new Promise((e=>e(s||("function"==typeof i.load?i.load(t,n):fetch(t,n).then((e=>e.text())))))).then((t=>(s||!1===i.cache||e.set(c,t),t))),i)(...r)},l=(...o)=>new Promise((e=>e(n))).then((n=>{const f=i.async?`async ${n}`:n;let a=e.get(f);const d=a?a.toString():((e,t)=>{const o=e=>32===e||9===e||13===e||10===e,n=e=>95===e||e>=97&&e<=122||e>=65&&e<=90,i=e=>n(e)||e>=48&&e<=57;let r=0,c=0;const s=e.length;let l="";const f=(t=r,o="")=>{(t>c||o)&&(l+=`yield \`${e.slice(c,t)}${o}\`;\n`)},a=t=>{r>c&&(l+=t?`yield (${e.slice(c,r)});\n`:`yield this.escape(${e.slice(c,r)});\n`)},d=()=>{r>c&&(l+=e.slice(c,r))},h=t=>{throw new SyntaxError(`Expected end of ${t} at\n${e}`)},u=t=>{const o=e.charCodeAt(r+1);return 60===t&&123===o?(f(),r+=2,p(),!0):123===t&&61===o?(f(),r+=2,C(!1),!0):123===t&&126===o?(f(),r+=2,C(!0),!0):123===t&&64===o?(f(),r+=2,b(),!0):92===t?(f(r,"\\\\"),r++,c=r,!0):96===t?(f(r,"\\`"),r++,c=r,!0):36===t&&(f(r,"\\$"),r++,c=r,!0)},p=()=>{c=r;let t=!0;for(;r<s;){if($()){t=!1;continue}const n=e.charCodeAt(r);if(123===n){r++;const o=e.charCodeAt(r);61===o||126===o?(t=!1,d(),r++,C(126===o),c--):64===o?(t=!1,r--,d(),r+=2,b()):t=!0}else if(t&&o(n))r++;else if(t&&60===n)t=!1,d(),g();else if(t&&62===n)t=!1,d(),r++,y();else{if(125===n&&62===e.charCodeAt(r+1))return d(),r+=2,void(c=r);r++,t=!1}}h("logic block }>")},g=()=>{c=r;let t=-1;for(;r<s;){const n=e.charCodeAt(r);if(62===n)r++,t=r;else if(t>=0&&o(n))r++;else{if(t>=0&&125===n)return f(t),void(c=r);u(n)||(r++,t=-1)}}h("html block >}")},y=()=>{c=r;let t=-1,n=-1,i=!1;for(;r<s;){const s=e.charCodeAt(r);if(!i&&o(s))c++,r++;else if(i&&(60===s||o(s)))n<0&&(n=r),60===s&&(t=r),r++;else if(t>=0&&o(s))r++;else{if(t>=0&&125===s)return f(n),void(c=r);u(s)||(r++,t=-1,n=-1),i=!0}}h("text block <}")},C=t=>{c=r;const n=t?126:61;let i=!1;for(;r<s;){if($()){i=!0;continue}const s=e.charCodeAt(r);if(!i&&o(s))r++;else{if(s===n&&125===e.charCodeAt(r+1))return i?a(t):l+=`yield \`${e.slice(c,r)}\`;`,r+=2,void(c=r);r++,i=!0}}h("output block "+(t?"~}":"=}"))},$=()=>{let t=0,o=0,n=!1;for(;r<s;){const i=e.charCodeAt(r);let c=0;if(t||o||39!==i&&34!==i&&96!==i)if(t&&92===i)r+=2;else{if(t&&i===t)return r++,!0;if(t||o||47!==i||47!==(c=e.charCodeAt(r+1))&&42!==c){if(47===o&&10===i)return r++,!0;if(42===o&&42===i&&47===e.charCodeAt(r+1))return r+=2,!0;if(!o&&!t)return!1;r++}else o=c,r+=2,n=!0}else t=i,r++,n=!0}return n&&t&&h(`string ${String.fromCharCode(t)}`),n&&42===o&&h("comment */"),n},b=()=>{c=r;let t=0,o=!1,l="";for(;r<s;){let s=e.charCodeAt(r);if(t){if(!o||!i(s)){if(o&&!i(s)){if(l=e.slice(c,r),s=v(s),40===s){r++,m(l);break}if(39===s||34===s||96===s){c=r,r++,k(l);break}A();break}A();break}r++}else{if(s=v(s),c=r,t=s,40===s){r++,m();break}if(39===s||34===s||96===s){r++,k();break}if(!n(t)){A();break}r++,o=!0}}v(e.charCodeAt(r)),c=r},A=()=>{for(;r<s;){if(64===e.charCodeAt(r)&&125===e.charCodeAt(r+1)&&r>c)return l+=`let[${e.slice(c,r)}]=this;\n`,void(r+=2);r++}h("declaration block @}")},k=t=>{for(;r<s;){if(64===e.charCodeAt(r)&&125===e.charCodeAt(r+1)&&r>c)return t&&(l+=`let ${t}=`),l+=`this.load(${e.slice(c,r)})\n`,void(r+=2);r++}h("declaration block @}")},m=n=>{c=r;let i="",a=0;for(;r<s;){const t=e.charCodeAt(r);if(40===t)a++;else if(41===t){if(!a){i=e.slice(c,r),r++,v(e.charCodeAt(r)),c=r;break}a--,r++}else r++}const d=l;let p=-1;for(l="";r<s;){const c=e.charCodeAt(r);if(o(c))p=r,r++;else{if(64===c&&125===e.charCodeAt(r+1)){f(p>-1?p:r);const e=l;return l=d,n&&(l+=`let ${n}=`),l+=`(${t.async?"async ":""}function*(${i}){${e}}.bind(this))\n`,void(r+=2)}u(c)||r++}}h("declaration block @}")},v=t=>{for(;r<s&&o(t);)r++,t=e.charCodeAt(r);return t};for(;r<s;){const t=e.charCodeAt(r);u(t)||r++}return f(),`return(${t.async?"async ":""}function*(){\n${l}}).call(this)`})(n,i);l.toString=()=>`function () {\n${d}\n}`;try{a&&"string"!=typeof a||(a=Function(d),a.toString=()=>d,!1!==i.cache&&e.set(f,a)),i.verbose&&(console.groupCollapsed("(function () {"),console.log(`${d}})\n(`,...o.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const n=(...e)=>l(...e);n[Symbol.iterator]=function*(){yield*o};for(let e=0;e<o.length;e++)n[e]=o[e];n.load=s,n.escape=c;for(const e in r)n[e]=r[e];return t(a.apply(n))}catch(e){throw e.message+=`\nat function () {\n${d}\n})(${o.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,e}}));return l};return o.options={},o.cache=e,o}));//# sourceMappingURL=nostache.min.js.map
