!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e=new Map,t=e=>{if("function"==typeof e.next){let n="",o=()=>new Promise((t=>t(e.next()))).then((e=>e.done?n:t(e.value).then((e=>n+=e)).then(o)));return o().then((()=>n))}return new Promise((t=>t(e)))},n=(o,r)=>{r=Object.assign(Object.assign({},n.options),r);const c=e=>t(e).then("function"==typeof r.escape?r.escape:e=>String(e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`))),i=(e,t)=>n("function"==typeof r.load?r.load(e,t):fetch(e,t).then((e=>e.text()))),s=(...n)=>new Promise((e=>e(o))).then((o=>{const f=r.async?`async ${o}`:o;let l=e.get(f);const a=l?l.toString():((e,t)=>{const n=e=>{if(e.length>1){const t={};for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=!0;return t}return e.charCodeAt(0)},o=n(" \t\r\n"),r=e=>95===e||e>=65&&e<=90||e>=97&&e<=122,c=e=>r(e)||e>=48&&e<=57,i=n("<"),s=n(">"),f=n("{"),l=n("}"),a=n("("),h=n(")"),d=n("="),u=n("~"),p=n("/"),C=n("*"),A=n("\n"),b=n("\\"),$=n("'"),y=n('"'),g=n("`"),k=n("$"),m=n("@");let w=0,x=0;const S=e.length;let j="";const P=(t=w,n="")=>{(t>x||n)&&(j+=`yield \`${e.slice(x,t)}${n}\`;\n`)},v=t=>{w>x&&(j+=t?`yield (${e.slice(x,w)});\n`:`yield this.escape(${e.slice(x,w)});\n`)},O=()=>{w>x&&(j+=e.slice(x,w))},T=t=>{const n=e.charCodeAt(w+1);return t===i&&n===f?(P(),w+=2,E(),!0):t===f&&n===d?(P(),w+=2,N(!1),!0):t===f&&n===u?(P(),w+=2,N(!0),!0):t===f&&n===m?(P(),w+=2,z(),!0):t===b?(P(w,"\\\\"),w++,x=w,!0):t===g?(P(w,"\\`"),w++,x=w,!0):t===k&&(P(w,"\\$"),w++,x=w,!0)},E=()=>{x=w;let t=!0;for(;w<S;){if(q()){t=!1;continue}const n=e.charCodeAt(w);if(n===f){w++;const n=e.charCodeAt(w);n===s?(t=!1,O(),w++,M()):n===d||n===u?(t=!1,O(),w++,N(n===u),x--):n===m?(t=!1,w--,O(),w+=2,z()):t=!0}else if(t&&o[n])w++;else if(t&&n===i)t=!1,O(),F();else{if(n===l&&e.charCodeAt(w+1)===s){O(),w+=2;break}w++,t=!1}}x=w},F=()=>{x=w;let t=-1;for(;w<S;){const n=e.charCodeAt(w);if(n===s)w++,t=w;else if(t>=0&&o[n])w++;else{if(t>=0&&n===l){P(t);break}T(n)||(w++,t=-1)}}x=w},M=()=>{x=w;let t=-1,n=-1,r=!1;for(;w<S;){const c=e.charCodeAt(w);if(!r&&o[c])x++,w++;else if(r&&(c===i||o[c]))n<0&&(n=w),c===i&&(t=w),w++;else if(t>=0&&o[c])w++;else{if(t>=0&&c===l){P(n);break}T(c)||(w++,t=-1,n=-1),r=!0}}x=w},N=t=>{x=w;const n=t?u:d;let r=!1;for(;w<S;){if(q()){r=!0;continue}const c=e.charCodeAt(w);if(!r&&o[c])w++;else{if(c===n&&e.charCodeAt(w+1)===l){r&&v(t),w+=2;break}w++,r=!0}}x=w},q=()=>{let t=0,n=0,o=!1;for(;w<S;){const r=e.charCodeAt(w);let c=0;if(t||n||r!==$&&r!==y&&r!==g)if(t&&r===b)w+=2;else{if(t&&r===t)return t=0,w++,!0;if(t||n||r!==p||(c=e.charCodeAt(w+1))!==p&&c!==C)if(n===p&&r===A)n=0,w++;else{if(n===C&&r===C&&e.charCodeAt(w+1)===p)return n=0,w+=2,!0;if(!n&&!t)return!1;w++}else n=c,w+=2,o=!0}else t=r,w++,o=!0}return o},z=()=>{x=w;let t=0,n=!1,o="";for(;w<S;){let i=e.charCodeAt(w);if(t){if(!n||!c(i)){if(n&&!c(i)){if(o=e.slice(x,w),i=H(i),i===a){w++,G(o);break}if(i===$||i===y||i===g){x=w,w++,D(o);break}B();break}B();break}w++}else{if(i=H(i),x=w,t=i,i===a){w++,G();break}if(i===$||i===y||i===g){w++,D();break}if(!r(t)){B();break}w++,n=!0}}H(e.charCodeAt(w)),x=w},B=()=>{for(;w<S;){if(e.charCodeAt(w)===m&&e.charCodeAt(w+1)===l&&w>x){j+=`let[${e.slice(x,w)}]=this;\n`,w+=2;break}w++}},D=t=>{for(;w<S;){if(e.charCodeAt(w)===m&&e.charCodeAt(w+1)===l&&w>x){t&&(j+=`let ${t}=`),j+=`this.load(${e.slice(x,w)})\n`,w+=2;break}w++}},G=n=>{x=w;let r="",c=0;for(;w<S;){const t=e.charCodeAt(w);if(t===a)c++;else if(t===h){if(!c){r=e.slice(x,w),w++,H(e.charCodeAt(w)),x=w;break}c--,w++}else w++}const i=j;let s=-1;for(j="";w<S;){const c=e.charCodeAt(w);if(o[c])s=w,w++;else{if(c===m&&e.charCodeAt(w+1)===l){P(s>-1?s:w);const e=j;j=i,n&&(j+=`let ${n}=`),j+=`(${t.async?"async ":""}function*(${r}){${e}}.bind(this))\n`,w+=2;break}T(c)||w++}}},H=t=>{for(;w<S&&o[t];)w++,t=e.charCodeAt(w);return t};for(;w<S;){const t=e.charCodeAt(w);T(t)||w++}return P(),`return(${t.async?"async ":""}function*(){\n${j}}).call(this)`})(o,r);s.toString=()=>`function () {\n${a}\n}`,l||(l=Function(a),l.toString=()=>a,!1!==r.cache&&e.set(f,l));try{r.verbose&&(console.groupCollapsed("(function () {"),console.log(`${a}})\n(`,...n.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const e=(...e)=>s(...e);e[Symbol.iterator]=function*(){yield*n};for(let t=0;t<n.length;t++)e[t]=n[t];return e.load=i,e.escape=c,t(l.apply(e))}catch(e){throw e.message+=`\nat function () {\n${a}\n})(${n.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,e}}));return s};return n.options={},n.cache=e,n}));//# sourceMappingURL=nostache.min.js.map
