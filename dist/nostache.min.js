!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e={},t=async e=>String(await e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`)),o=async e=>{let t="";for(;;){const n=await e.next();if(n.done)break;"function"==typeof n.value?.next?t+=await o(n.value):t+=await n.value}return t},n=r=>{const s=e[r]??(e[r]=(e=>{const t=e=>{if(e.length>1){const t={};for(let o=0;o<e.length;o++)t[e.charCodeAt(o)]=!0;return t}return e.charCodeAt(0)},o=t(" \t\r\n"),n=t("<"),r=t(">"),s=t("{"),c=t("}"),i=t("="),f=t("~"),l=t("/"),a=t("*"),u=t("\n"),h=t("\\"),d=t("'"),p=t('"'),y=t("`"),A=t("$");let C=0,$=0;const g=e.length;let b="";const v=(t=C,o="")=>{(t>$||o)&&(b+=`yield \`${e.slice($,t)}${o}\`;\n`)},w=t=>{C>$&&(b+=t?`yield (${e.slice($,C)});\n`:`yield this.escape(${e.slice($,C)});\n`)},j=()=>{C>$&&(b+=`${e.slice($,C)}`)},k=t=>t===n&&e.charCodeAt(C+1)===s?(v(),C+=2,m(),!0):t===s&&e.charCodeAt(C+1)===i?(v(),C+=2,S(!1),!0):t===s&&e.charCodeAt(C+1)===f?(v(),C+=2,S(!0),!0):t===h?(v(C,"\\\\"),C++,$=C,!0):t===y?(v(C,"\\`"),C++,$=C,!0):t===A&&(v(C,"\\$"),C++,$=C,!0),m=()=>{$=C;let t=!0;for(;C<g;){if(T()){t=!1;continue}const l=e.charCodeAt(C);if(l===s)C++,t=!0;else if(t&&o[l])C++;else if(t&&l===n)t=!1,j(),x();else if(t&&l===r)t=!1,j(),C++,N();else if(!t||l!==i&&l!==f){if(l===c&&e.charCodeAt(C+1)===r){j(),C+=2;break}C++,t=!1}else t=!1,j(),C++,S(l===f),$--}$=C},x=()=>{$=C;let t=-1;for(;C<g;){const n=e.charCodeAt(C);if(n===r)C++,t=C;else if(t>=0&&o[n])C++;else{if(t>=0&&n===c){v(t);break}k(n)||(C++,t=-1)}}$=C},N=()=>{$=C;let t=-1,r=-1,s=!1;for(;C<g;){const i=e.charCodeAt(C);if(!s&&o[i])$++,C++;else if(s&&(i===n||o[i]))r<0&&(r=C),i===n&&(t=C),C++;else if(t>=0&&o[i])C++;else{if(t>=0&&i===c){v(r);break}k(i)||(C++,t=-1,r=-1),s=!0}}$=C},S=t=>{$=C;const n=t?f:i;let r=!1;for(;C<g;){if(T()){r=!0;continue}const s=e.charCodeAt(C);if(!r&&o[s])C++;else{if(s===n&&e.charCodeAt(C+1)===c){r&&w(t),C+=2;break}C++,r=!0}}$=C},T=()=>{let t=0,o=0,n=!1;for(;C<g;){const r=e.charCodeAt(C);let s=0;if(t||o||r!==d&&r!==p&&r!==y)if(t&&r===h)C+=2;else{if(t&&r===t)return t=0,C++,!0;if(t||o||r!==l||(s=e.charCodeAt(C+1))!==l&&s!==a)if(o===l&&r===u)o=0,C++;else{if(o===a&&r===a&&e.charCodeAt(C+1)===l)return o=0,C+=2,!0;if(!o&&!t)return!1;C++}else o=s,C+=2,n=!0}else t=r,C++,n=!0}return n};for(;C<g;){const t=e.charCodeAt(C);k(t)||C++}return v(),`return(async function*(){\n${b}}).call(this)`})(r)),c=async(...e)=>{const t=[],n=[];for(const o of e)if(o&&"object"==typeof o&&!Array.isArray(o))for(const e in o)/^[_a-z]\w*$/i.test(e)&&(t.push(e),n.push(o[e]));try{c.verbose&&(console.groupCollapsed(`(function Nostache(${t.join(", ")}) {`),console.log(`${s}})\n(`,...n.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const r=(...e)=>c(...e);for(let t=0;t<e.length;t++)r[t]=e[t];r.escape=c.escape;const i=Function(...t,s).apply(r,n);return o(i)}catch(e){throw e.message+=`\nat function (${t.join(", ")}) {\n${s}\n})(${n.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,e}};return c.verbose=n.verbose,c.escape=t,c.toString=()=>s,c};return n.verbose=!1,n.escape=t,n}));//# sourceMappingURL=nostache.min.js.map
