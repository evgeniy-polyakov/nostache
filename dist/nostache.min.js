!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e={},t=e=>{if("function"==typeof e.next){let n="",o=()=>new Promise((t=>t(e.next()))).then((e=>e.done?n:t(e.value).then((e=>n+=e)).then(o)));return o().then((()=>n))}return new Promise((t=>t(e)))},n=(o,r)=>{r=Object.assign(Object.assign({},n.options),r);const i=e=>t(e).then("function"==typeof r.escape?r.escape:e=>String(e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`))),c=(e,t)=>n("function"==typeof r.load?r.load(e,t):fetch(e,t).then((e=>e.text()))),s=(...n)=>new Promise((e=>e(o))).then((o=>{const f=r.async?`async ${o}`:o;let l=e[f];const a=l?l.toString():((e,t)=>{const n=e=>{if(e.length>1){const t={};for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=!0;return t}return e.charCodeAt(0)},o=n(" \t\r\n"),r=e=>95===e||e>=65&&e<=90||e>=97&&e<=122,i=e=>r(e)||e>=48&&e<=57,c=n("<"),s=n(">"),f=n("{"),l=n("}"),a=n("("),h=n(")"),d=n("="),u=n("~"),C=n("/"),p=n("*"),A=n("\n"),$=n("\\"),b=n("'"),y=n('"'),g=n("`"),k=n("$"),m=n("@");let x=0,S=0;const j=e.length;let w="";const P=(t=x,n="")=>{(t>S||n)&&(w+=`yield \`${e.slice(S,t)}${n}\`;\n`)},v=t=>{x>S&&(w+=t?`yield (${e.slice(S,x)});\n`:`yield this.escape(${e.slice(S,x)});\n`)},O=()=>{x>S&&(w+=`${e.slice(S,x)}`)},T=t=>{const n=e.charCodeAt(x+1);return t===c&&n===f?(P(),x+=2,E(),!0):t===f&&n===d?(P(),x+=2,q(!1),!0):t===f&&n===u?(P(),x+=2,q(!0),!0):t===f&&n===m?(P(),x+=2,B(),!0):t===$?(P(x,"\\\\"),x++,S=x,!0):t===g?(P(x,"\\`"),x++,S=x,!0):t===k&&(P(x,"\\$"),x++,S=x,!0)},E=()=>{S=x;let t=!0;for(;x<j;){if(z()){t=!1;continue}const n=e.charCodeAt(x);if(n===f){x++;const n=e.charCodeAt(x);n===s?(t=!1,O(),x++,N()):n===d||n===u?(t=!1,O(),x++,q(n===u),S--):n===m?(t=!1,x--,O(),x+=2,B()):t=!0}else if(t&&o[n])x++;else if(t&&n===c)t=!1,O(),F();else{if(n===l&&e.charCodeAt(x+1)===s){O(),x+=2;break}x++,t=!1}}S=x},F=()=>{S=x;let t=-1;for(;x<j;){const n=e.charCodeAt(x);if(n===s)x++,t=x;else if(t>=0&&o[n])x++;else{if(t>=0&&n===l){P(t);break}T(n)||(x++,t=-1)}}S=x},N=()=>{S=x;let t=-1,n=-1,r=!1;for(;x<j;){const i=e.charCodeAt(x);if(!r&&o[i])S++,x++;else if(r&&(i===c||o[i]))n<0&&(n=x),i===c&&(t=x),x++;else if(t>=0&&o[i])x++;else{if(t>=0&&i===l){P(n);break}T(i)||(x++,t=-1,n=-1),r=!0}}S=x},q=t=>{S=x;const n=t?u:d;let r=!1;for(;x<j;){if(z()){r=!0;continue}const i=e.charCodeAt(x);if(!r&&o[i])x++;else{if(i===n&&e.charCodeAt(x+1)===l){r&&v(t),x+=2;break}x++,r=!0}}S=x},z=()=>{let t=0,n=0,o=!1;for(;x<j;){const r=e.charCodeAt(x);let i=0;if(t||n||r!==b&&r!==y&&r!==g)if(t&&r===$)x+=2;else{if(t&&r===t)return t=0,x++,!0;if(t||n||r!==C||(i=e.charCodeAt(x+1))!==C&&i!==p)if(n===C&&r===A)n=0,x++;else{if(n===p&&r===p&&e.charCodeAt(x+1)===C)return n=0,x+=2,!0;if(!n&&!t)return!1;x++}else n=i,x+=2,o=!0}else t=r,x++,o=!0}return o},B=()=>{S=x;let t=0,n=!1,o="";for(;x<j;){let c=e.charCodeAt(x);if(t){if(!n||!i(c)){if(n&&!i(c)){if(o=e.slice(S,x),c=I(c),c===a){x++,H(o);break}if(c===b||c===y||c===g){S=x,x++,G(o);break}D();break}D();break}x++}else{if(c=I(c),S=x,t=c,c===a){x++,H();break}if(c===b||c===y||c===g){x++,G();break}if(!r(t)){D();break}x++,n=!0}}I(e.charCodeAt(x)),S=x},D=()=>{for(;x<j;){if(e.charCodeAt(x)===m&&e.charCodeAt(x+1)===l&&x>S){w+=`let[${e.slice(S,x)}]=this;\n`,x+=2;break}x++}},G=t=>{for(;x<j;){if(e.charCodeAt(x)===m&&e.charCodeAt(x+1)===l&&x>S){t&&(w+=`let ${t}=`),w+=`this.load(${e.slice(S,x)})\n`,x+=2;break}x++}},H=n=>{S=x;let r="",i=0;for(;x<j;){const t=e.charCodeAt(x);if(t===a)i++;else if(t===h){if(!i){r=e.slice(S,x),x++,I(e.charCodeAt(x)),S=x;break}i--,x++}else x++}const c=w;let s=-1;for(w="";x<j;){const i=e.charCodeAt(x);if(o[i])s=x,x++;else{if(i===m&&e.charCodeAt(x+1)===l){P(s>-1?s:x);const e=w;w=c,n&&(w+=`let ${n}=`),w+=`(${t.async?"async ":""}function*(${r}){${e}}.bind(this))\n`,x+=2;break}T(i)||x++}}},I=t=>{for(;x<j&&o[t];)x++,t=e.charCodeAt(x);return t};for(;x<j;){const t=e.charCodeAt(x);T(t)||x++}return P(),`return(${t.async?"async ":""}function*(){\n${w}}).call(this)`})(o,r);s.toString=()=>`function () {\n${a}\n}`,l||(l=Function(a),l.toString=()=>a,e[f]=l);try{r.verbose&&(console.groupCollapsed("(function () {"),console.log(`${a}})\n(`,...n.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const e=(...e)=>s(...e);e[Symbol.iterator]=function*(){yield*n};for(let t=0;t<n.length;t++)e[t]=n[t];return e.load=c,e.escape=i,t(l.apply(e))}catch(e){throw e.message+=`\nat function () {\n${a}\n})(${n.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,e}}));return s};return n.options={},n}));//# sourceMappingURL=nostache.min.js.map
