!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e={},t=async e=>String(await e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`)),o=async e=>{let t="";for(;;){const n=await e.next();if(n.done)break;"function"==typeof n.value?.next?t+=await o(n.value):t+=await n.value}return t},n=s=>{const r=e[s]??(e[s]=(e=>{const t=e=>{if(e.length>1){const t={};for(let o=0;o<e.length;o++)t[e.charCodeAt(o)]=!0;return t}return e.charCodeAt(0)},o=t(" \t\r\n"),n=t("<"),s=t(">"),r=t("{"),c=t("}"),i=t("="),l=t("~"),f=t("\\"),a=t("'"),h=t('"'),u=t("`"),d=t("$");let p=0,y=0;const $=e.length;let g="";const A=(t=p,o="")=>{(t>y||o)&&(g+=`yield \`${e.slice(y,t)}${o}\`;\n`)},C=t=>{p>y&&(g+=t?`yield ${e.slice(y,p)};\n`:`yield this.escape(${e.slice(y,p)});\n`)},b=()=>{p>y&&(g+=`${e.slice(y,p)}`)},v=t=>t===n&&e.charCodeAt(p+1)===r?(A(),p+=2,w(),!0):t===r&&e.charCodeAt(p+1)===i?(A(),p+=2,m(!1),!0):t===r&&e.charCodeAt(p+1)===l?(A(),p+=2,m(!0),!0):t===f?(A(p,"\\\\"),p++,y=p,!0):t===u?(A(p,"\\`"),p++,y=p,!0):t===d&&(A(p,"\\$"),p++,y=p,!0),w=()=>{y=p;let t=0,d=!0;for(;p<$;){const $=e.charCodeAt(p);if(t||$!==a&&$!==h&&$!==u)if(t&&$===f)p+=2;else if(t&&$===t)t=0,p++;else if(t||$!==r)if(d&&o[$])p++;else if(d&&$===n)d=!1,b(),j();else if(d&&$===s)d=!1,b(),p++,k();else if(!d||$!==i&&$!==l){if(!t&&$===c&&e.charCodeAt(p+1)===s){b(),p+=2;break}p++,d=!1}else d=!1,b(),p++,m($===l),y--;else p++,d=!0;else t=$,p++,d=!1}y=p},j=()=>{y=p;let t=-1;for(;p<$;){const n=e.charCodeAt(p);if(n===s)p++,t=p;else if(t>=0&&o[n])p++;else{if(t>=0&&n===c){A(t);break}v(n)||(p++,t=-1)}}y=p},k=()=>{y=p;let t=-1,s=-1,r=!1;for(;p<$;){const i=e.charCodeAt(p);if(!r&&o[i])y++,p++;else if(r&&(i===n||o[i]))s<0&&(s=p),i===n&&(t=p),p++;else if(t>=0&&o[i])p++;else{if(t>=0&&i===c){A(s);break}v(i)||(p++,t=-1,s=-1),r=!0}}y=p},m=t=>{y=p;const n=t?l:i;let s=!1,r=0;for(;p<$;){const i=e.charCodeAt(p);if(!s&&o[i])p++;else if(r||i!==a&&i!==h&&i!==u)if(r&&i===f)p+=2;else if(r&&i===r)r=0,p++;else{if(!r&&i===n&&e.charCodeAt(p+1)===c){s&&C(t),p+=2;break}p++,s=!0}else r=i,p++,s=!0}y=p};for(;p<$;){const t=e.charCodeAt(p);v(t)||p++}return A(),`return(async function*(){\n${g}}).call(this)`})(s)),c=async(...e)=>{const t=[],n=[];for(const o of e)if(o&&"object"==typeof o&&!Array.isArray(o))for(const e in o)/^[_a-z]\w*$/i.test(e)&&(t.push(e),n.push(o[e]));try{c.verbose&&(console.groupCollapsed(`(function Nostache(${t.join(", ")}) {`),console.log(`${r}})\n(`,...n.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const s=(...e)=>c(...e);for(let t=0;t<e.length;t++)s[t]=e[t];s.escape=c.escape;const i=Function(...t,r).apply(s,n);return o(i)}catch(e){throw e.message+=`\nat function (${t.join(", ")}) {\n${r}\n})(${n.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,e}};return c.verbose=n.verbose,c.escape=t,c.toString=()=>r,c};return n.verbose=!1,n.escape=t,n}));//# sourceMappingURL=nostache.min.js.map
