!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e="async",t="import",o="function",n=e=>"string"==typeof e,r=e=>typeof e===o,i=e=>{if(e&&r(e.next)){let t="",o=()=>new Promise((t=>t(e.next()))).then((e=>e.done?t:i(e.value).then((e=>t+=e)).then(o)));return o().then((()=>t))}return new Promise((t=>t(e)))},c=Function("try{return this===window;}catch(e){}")(),s=(l,f)=>{f=Object.assign(Object.assign({},s.options),f);const a=Object.assign(Object.assign({},s.options?s.options.extensions:void 0),f?f.extensions:void 0),d=!1===f.cache?0:f.cache||3,h=e=>i(e).then(r(f.escape)?f.escape:e=>null==e?"":String(e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`))),u=e=>(...o)=>s(new Promise(((o,n)=>{const i=1&d?s.cache.get(e,t):void 0;if(void 0!==i)o(i);else{const t=t=>{1&d&&s.cache.set(e,t),o(t)};try{const o=f.import;r(o)?new Promise((t=>t(o(e)))).then(t):c?fetch(e).then((e=>200===e.status?e.text().then(t):n(new Error(`${e.status} ${e.url}`)))):require("fs").readFile(e,"utf8",((e,o)=>e?n(e):t(o)))}catch(e){n(e)}}})),f)(...o),$=(...t)=>new Promise((e=>e(l))).then((r=>{const c=f.async?e:void 0;let l=2&d?s.cache.get(r,c):void 0;const p=l?l.toString():((e,t)=>{const n=e=>32===e||9===e||13===e||10===e,r=e=>95===e||e>=97&&e<=122||e>=65&&e<=90,i=e=>r(e)||e>=48&&e<=57,c=t.async?"async ":"";let s=0,l=0;const f=e.length;let a="";const d=(t=s,o="")=>{(t>l||o)&&(a+=`yield \`${e.slice(l,t)}${o}\`;\n`)},h=t=>{s>l&&(a+=t?`yield (${e.slice(l,s)});\n`:`yield this.escape(${e.slice(l,s)});\n`)},u=()=>{s>l&&(a+=e.slice(l,s))},$=t=>{throw new SyntaxError(`Expected end of ${t} at\n${e}`)},p=()=>$("declaration block @}"),C=t=>{const o=e.charCodeAt(s+1);return 60===t&&123===o?(d(),s+=2,A(),!0):123===t&&61===o?(d(),s+=2,y(!1),!0):123===t&&126===o?(d(),s+=2,y(!0),!0):123===t&&64===o?(d(),s+=2,v(),!0):92===t?(d(s,"\\\\"),s++,l=s,!0):96===t?(d(s,"\\`"),s++,l=s,!0):36===t&&(d(s,"\\$"),s++,l=s,!0)},A=()=>{l=s;let t=!1;for(;s<f;){if(m())continue;const o=e.charCodeAt(s);if(123===o){s++;const o=e.charCodeAt(s);62===o?(t=!1,u(),s++,b()):61===o||126===o?(t=!1,u(),s++,y(126===o),l--):64===o?(t=!1,s--,u(),s+=2,v()):t=!0}else if(t&&n(o))s++;else if(t&&60===o)t=!1,u(),g();else{if(125===o&&62===e.charCodeAt(s+1))return u(),s+=2,void(l=s);s++,t=!1}}$("logic block }>")},g=()=>{l=s;let t=-1;for(;s<f;){const o=e.charCodeAt(s);if(62===o)s++,t=s;else if(t>=0&&n(o))s++;else if(t>=0&&m(!0));else{if(t>=0&&125===o)return d(t),void(l=s);C(o)||(s++,t=-1)}}$("html block >}")},b=()=>{l=s;let t=-1,o=-1,r=!1;for(;s<f;){const i=e.charCodeAt(s);if(!r&&n(i))l++,s++;else if(C(i))r=!0,t=-1,o=-1;else if(60===i||n(i))o<0&&(o=s),60===i&&(t=s),s++;else if(t>=0&&n(i))s++;else{if(t>=0&&125===i)return r&&d(o),void(l=s);s++,t=-1,o=-1,r=!0}}$("text block <}")},y=t=>{l=s;const o=t?126:61;let r=!1,i=!1;for(;s<f;){const c=m();if(1===c){r=!0;continue}2!==c||r||(i=!0,l=s);const f=e.charCodeAt(s);if(!r&&n(f))s++;else{if(f===o&&125===e.charCodeAt(s+1))return r?h(t):i||(a+=`yield \`${e.slice(l,s)}\`;`),s+=2,void(l=s);s++,r=!0}}$("output block "+(t?"~}":"=}"))},m=(t=!1)=>{let o=0,n=0,r=0;for(;s<f;){const i=e.charCodeAt(s);let c=0;if(t||o||n||39!==i&&34!==i&&96!==i)if(o&&92===i)s+=2;else{if(o&&i===o)return s++,1;if(o||n||47!==i||47!==(c=e.charCodeAt(s+1))&&42!==c){if(47===n&&10===i)return s++,2;if(42===n&&42===i&&47===e.charCodeAt(s+1))return s+=2,2;if(!n&&!o)return 0;s++}else n=c,s+=2,r=2}else o=i,s++,r=1}return r&&o&&$(`string ${String.fromCharCode(o)}`),r&&42===n&&$("comment */"),r},v=()=>{l=s;let t=0,o=!1,n="";for(;s<f;){let c=e.charCodeAt(s);if(t){if(!o||!i(c)){if(o&&!i(c)){if(n=e.slice(l,s),c=S(c),m(!0)&&(c=S(e.charCodeAt(s))),40===c){s++,x(n);break}if(39===c||34===c||96===c){l=s,s++,w(n);break}k();break}k();break}s++}else{if(c=S(c),m(!0)&&(c=S(e.charCodeAt(s))),l=s,t=c,40===c){s++,x();break}if(39===c||34===c||96===c){s++,w();break}if(!r(t)){if(64===c&&125===e.charCodeAt(s+1))return s+=2,void(l=s);k();break}s++,o=!0}}S(e.charCodeAt(s)),l=s},k=()=>{for(;s<f;)if(m(!0));else{if(64===e.charCodeAt(s)&&125===e.charCodeAt(s+1)&&s>l)return a+=`let[${e.slice(l,s)}]=this;\n`,void(s+=2);s++}p()},w=t=>{for(;s<f;)if(m(!0));else{if(64===e.charCodeAt(s)&&125===e.charCodeAt(s+1)&&s>l)return t&&(a+=`let ${t}=`),a+=`this.import(${e.slice(l,s)})\n`,void(s+=2);s++}p()},x=t=>{l=s;let r="",i=0;for(;s<f;){const t=e.charCodeAt(s);if(40===t)i++;else if(41===t){if(!i){r=e.slice(l,s),s++,S(e.charCodeAt(s)),l=s;break}i--,s++}else s++}const h=a;let u=-1;for(a="";s<f;){const i=e.charCodeAt(s);if(n(i))u=s,S(i);else{if(64===i&&125===e.charCodeAt(s+1)){d(u>-1?u:s);const e=a;return a=h,t&&(a+=`let ${t}=`),a+=`(${c}${o}*(${r}){${e}}.bind(this))\n`,void(s+=2)}C(i)||s++}}p()},S=t=>{for(;s<f&&n(t);)s++,t=e.charCodeAt(s);return t};for(;s<f;){const t=e.charCodeAt(s);C(t)||s++}return d(),`return(${c}${o}*(){\n${a}}).call(this)`})(r,f);$.toString=()=>`${o} () {\n${p}\n}`;try{l||(l=Function(p),l.toString=()=>p,2&d&&s.cache.set(r,l,c)),f.verbose&&(console.groupCollapsed(`(${o} () {`),console.log(`${p}})\n(`,...t.reduce(((e,t)=>(e.length>0&&e.push(","),e.push(n(t)?`"${t}"`:t),e)),[]),")"),console.groupEnd());const e=(...e)=>$(...e);e[Symbol.iterator]=function*(){yield*t};for(let o=0;o<t.length;o++)e[o]=t[o];e.import=u,e.escape=h;for(const t in a)e[t]=a[t];return i(l.apply(e))}catch(e){throw e.message+=`\nat ${o} () {\n${p}\n})(${t.map((e=>n(e)?`"${e}"`:e)).join(", ")})`,e}}));return $};return s.options={},s.cache=(()=>{let o={},r={},i={};return{get:(n,c)=>c===t?i[n]:c===e?r[n]:o[n],set(t,c,s){n(c)?i[t]=c:s===e?r[t]=c:o[t]=c},delete(n,c){c===t?delete i[n]:c===e?delete r[n]:delete o[n]},clear(){o={},r={},i={}}}})(),s}));//# sourceMappingURL=nostache.min.js.map
