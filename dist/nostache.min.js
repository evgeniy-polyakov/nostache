!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e=new Map,t=e=>{if("function"==typeof e.next){let n="",o=()=>new Promise((t=>t(e.next()))).then((e=>e.done?n:t(e.value).then((e=>n+=e)).then(o)));return o().then((()=>n))}return new Promise((t=>t(e)))},n=(o,r)=>{r=Object.assign(Object.assign({},n.options),r);const c=e=>t(e).then("function"==typeof r.escape?r.escape:e=>String(e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`))),i=(e,t)=>n("function"==typeof r.load?r.load(e,t):fetch(e,t).then((e=>e.text()))),s=(...n)=>new Promise((e=>e(o))).then((o=>{const f=r.async?`async ${o}`:o;let l=e.get(f);const a=l?l.toString():((e,t)=>{const n=e=>32===e||9===e||13===e||10===e,o=e=>95===e||e>=97&&e<=122||e>=65&&e<=90,r=e=>o(e)||e>=48&&e<=57;let c=0,i=0;const s=e.length;let f="";const l=(t=c,n="")=>{(t>i||n)&&(f+=`yield \`${e.slice(i,t)}${n}\`;\n`)},a=()=>{c>i&&(f+=e.slice(i,c))},h=t=>{const n=e.charCodeAt(c+1);return 60===t&&123===n?(l(),c+=2,d(),!0):123===t&&61===n?(l(),c+=2,C(!1),!0):123===t&&126===n?(l(),c+=2,C(!0),!0):123===t&&64===n?(l(),c+=2,b(),!0):92===t?(l(c,"\\\\"),c++,i=c,!0):96===t?(l(c,"\\`"),c++,i=c,!0):36===t&&(l(c,"\\$"),c++,i=c,!0)},d=()=>{i=c;let t=!0;for(;c<s;){if(A()){t=!1;continue}const o=e.charCodeAt(c);if(123===o){c++;const n=e.charCodeAt(c);62===n?(t=!1,a(),c++,p()):61===n||126===n?(t=!1,a(),c++,C(126===n),i--):64===n?(t=!1,c--,a(),c+=2,b()):t=!0}else if(t&&n(o))c++;else if(t&&60===o)t=!1,a(),u();else{if(125===o&&62===e.charCodeAt(c+1)){a(),c+=2;break}c++,t=!1}}i=c},u=()=>{i=c;let t=-1;for(;c<s;){const o=e.charCodeAt(c);if(62===o)c++,t=c;else if(t>=0&&n(o))c++;else{if(t>=0&&125===o){l(t);break}h(o)||(c++,t=-1)}}i=c},p=()=>{i=c;let t=-1,o=-1,r=!1;for(;c<s;){const s=e.charCodeAt(c);if(!r&&n(s))i++,c++;else if(r&&(60===s||n(s)))o<0&&(o=c),60===s&&(t=c),c++;else if(t>=0&&n(s))c++;else{if(t>=0&&125===s){l(o);break}h(s)||(c++,t=-1,o=-1),r=!0}}i=c},C=t=>{i=c;const o=t?126:61;let r=!1;for(;c<s;){if(A()){r=!0;continue}const s=e.charCodeAt(c);if(!r&&n(s))c++;else{if(s===o&&125===e.charCodeAt(c+1)){r?c>i&&(f+=t?`yield (${e.slice(i,c)});\n`:`yield this.escape(${e.slice(i,c)});\n`):f+=`yield \`${e.slice(i,c)}\`;`,c+=2;break}c++,r=!0}}i=c},A=()=>{let t=0,n=0,o=!1;for(;c<s;){const r=e.charCodeAt(c);let i=0;if(t||n||39!==r&&34!==r&&96!==r)if(t&&92===r)c+=2;else{if(t&&r===t)return t=0,c++,!0;if(t||n||47!==r||47!==(i=e.charCodeAt(c+1))&&42!==i)if(47===n&&10===r)n=0,c++;else{if(42===n&&42===r&&47===e.charCodeAt(c+1))return n=0,c+=2,!0;if(!n&&!t)return!1;c++}else n=i,c+=2,o=!0}else t=r,c++,o=!0}return o},b=()=>{i=c;let t=0,n=!1,f="";for(;c<s;){let s=e.charCodeAt(c);if(t){if(!n||!r(s)){if(n&&!r(s)){if(f=e.slice(i,c),s=k(s),40===s){c++,g(f);break}if(39===s||34===s||96===s){i=c,c++,$(f);break}y();break}y();break}c++}else{if(s=k(s),i=c,t=s,40===s){c++,g();break}if(39===s||34===s||96===s){c++,$();break}if(!o(t)){y();break}c++,n=!0}}k(e.charCodeAt(c)),i=c},y=()=>{for(;c<s;){if(64===e.charCodeAt(c)&&125===e.charCodeAt(c+1)&&c>i){f+=`let[${e.slice(i,c)}]=this;\n`,c+=2;break}c++}},$=t=>{for(;c<s;){if(64===e.charCodeAt(c)&&125===e.charCodeAt(c+1)&&c>i){t&&(f+=`let ${t}=`),f+=`this.load(${e.slice(i,c)})\n`,c+=2;break}c++}},g=o=>{i=c;let r="",a=0;for(;c<s;){const t=e.charCodeAt(c);if(40===t)a++;else if(41===t){if(!a){r=e.slice(i,c),c++,k(e.charCodeAt(c)),i=c;break}a--,c++}else c++}const d=f;let u=-1;for(f="";c<s;){const i=e.charCodeAt(c);if(n(i))u=c,c++;else{if(64===i&&125===e.charCodeAt(c+1)){l(u>-1?u:c);const e=f;f=d,o&&(f+=`let ${o}=`),f+=`(${t.async?"async ":""}function*(${r}){${e}}.bind(this))\n`,c+=2;break}h(i)||c++}}},k=t=>{for(;c<s&&n(t);)c++,t=e.charCodeAt(c);return t};for(;c<s;){const t=e.charCodeAt(c);h(t)||c++}return l(),`return(${t.async?"async ":""}function*(){\n${f}}).call(this)`})(o,r);s.toString=()=>`function () {\n${a}\n}`;try{l||(l=Function(a),l.toString=()=>a,!1!==r.cache&&e.set(f,l)),r.verbose&&(console.groupCollapsed("(function () {"),console.log(`${a}})\n(`,...n.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const o=(...e)=>s(...e);o[Symbol.iterator]=function*(){yield*n};for(let e=0;e<n.length;e++)o[e]=n[e];return o.load=i,o.escape=c,t(l.apply(o))}catch(e){throw e.message+=`\nat function () {\n${a}\n})(${n.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,e}}));return s};return n.options={},n.cache=e,n}));//# sourceMappingURL=nostache.min.js.map
