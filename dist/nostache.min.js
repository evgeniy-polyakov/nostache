!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e="async",t="import",n="function",o=e=>"string"==typeof e,i=e=>typeof e===n,s=e=>{if(e&&i(e.next)){let t="";const n=()=>new Promise((t=>t(e.next()))).then((e=>{const o=e.value,i=e.done;if(i&&void 0===o)return t;const r=s(o).then((e=>t+=e));return i?r:r.then(n)}));return n().then((()=>t))}return new Promise((t=>t(e)))},r=Function("try{return this===window;}catch(e){}")(),c=(l,f)=>{f=Object.assign(Object.assign({},c.options),f);const u=Object.assign(Object.assign({},c.options?c.options.extensions:void 0),f?f.extensions:void 0),a=f.cache,d=void 0===a||!0===a,h=d||a===t,$=d||a===n,p=e=>s(e).then(i(f.escape)?f.escape:e=>null==e?"":String(e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`))),g=e=>(...n)=>c(new Promise((t=>t(e))).then((e=>new Promise(((n,o)=>{e=String(e);const s=h?c.cache.get(e,t):void 0;if(void 0!==s)n(s);else{const t=t=>{h&&c.cache.set(e,t),n(t)};try{const n=f.import;i(n)?new Promise((t=>t(n(e)))).then(t):r?fetch(e).then((e=>200===e.status?e.text().then(t):o(new Error(`${e.status} ${e.url}`)))):require("fs").readFile(e,"utf8",((e,n)=>e?o(e):t(n)))}catch(e){o(e)}}})))),f)(...n),b=(...t)=>new Promise((e=>e(l))).then((i=>{const r=f.async?e:void 0;let l=$?c.cache.get(i,r):void 0;const a=l?l.toString():((e,t)=>{const o=e=>32===e||9===e||13===e||10===e,i=e=>95===e||e>=97&&e<=122||e>=65&&e<=90,s=e=>i(e)||e>=48&&e<=57,r=t.async?"async ":"",c=t=>e.charCodeAt(t);let l=0,f=0;const u=e.length;let a="";const d=(t=l,n="")=>{(t>f||n)&&(a+=`yield \`${e.slice(f,t)}${n}\`;\n`)},h=t=>{l>f&&(a+=t?`yield (${e.slice(f,l)});\n`:`yield this.escape(${e.slice(f,l)});\n`)},$=()=>{l>f&&(a+=`${e.slice(f,l)}\n`)},p=t=>{throw new SyntaxError(`Expected end of ${t} at\n${e}`)},g=()=>p("declaration block @}"),b=e=>{const t=c(l+1);return 60===e&&123===t?(d(),l+=2,y(),!0):123===e&&61===t?(d(),l+=2,k(!1),!0):123===e&&126===t?(d(),l+=2,k(!0),!0):123===e&&64===t?(d(),l+=2,x(),!0):92===e?(d(l,"\\\\"),l++,f=l,!0):96===e?(d(l,"\\`"),l++,f=l,!0):36===e&&(d(l,"\\$"),l++,f=l,!0)},y=()=>{f=l;let e=!1;for(;l<u;){if(w())continue;const t=c(l);if(123===t){l++;const t=c(l);61===t||126===t?(e=!1,$(),l++,k(126===t),f--):64===t?(e=!1,l--,$(),l+=2,x()):e=!0}else if(e&&o(t))l++;else if(e&&60===t)e=!1,$(),m();else if(e&&62===t)e=!1,$(),l++,v();else{if(125===t&&62===c(l+1))return $(),l+=2,void(f=l);l++,e=!1}}p("logic block }>")},m=()=>{f=l;let e=-1;for(;l<u;){const t=c(l);if(b(t))e=-1;else if(62===t)l++,e=l;else if(e>=0&&o(t))l++;else if(e>=0&&w(!0));else{if(e>=0&&125===t)return d(e),void(f=l);l++,e=-1}}p("html block >}")},v=()=>{f=l;let e=-1;for(;l<u;){const t=c(l);if(b(t))e=-1;else if(60===t)e=l,l++;else if(e>=0&&o(t))l++;else{if(e>=0&&125===t)return d(e),void(f=l);l++,e=-1}}p("text block <}")},k=t=>{f=l;const n=t?126:61;let i=!1,s=!1;for(;l<u;){const r=w();if(1===r){i=!0;continue}2!==r||i||(s=!0,f=l);const u=c(l);if(!i&&o(u))l++;else{if(u===n&&125===c(l+1))return i?h(t):s||(a+=`yield \`${e.slice(f,l)}\`;`),l+=2,void(f=l);l++,i=!0}}p("output block "+(t?"~}":"=}"))},w=(e=!1)=>{let t=0,n=0,o=0;for(;l<u;){const i=c(l);let s=0;if(e||t||n||39!==i&&34!==i&&96!==i)if(t&&92===i)l+=2;else{if(t&&i===t)return l++,1;if(t||n||47!==i||47!==(s=c(l+1))&&42!==s){if(47===n&&10===i)return l++,2;if(42===n&&42===i&&47===c(l+1))return l+=2,2;if(!n&&!t)return 0;l++}else n=s,l+=2,o=2}else t=i,l++,o=1}return o&&t&&p(`string ${String.fromCharCode(t)}`),o&&42===n&&p("comment */"),o},x=()=>{f=l;let t=0,n=!1,o="";for(;l<u;){let r=c(l);if(t){if(!n||!s(r)){if(n&&!s(r)){if(o=e.slice(f,l),r=C(),w(!0)&&(r=C()),40===r){l++,P(o);break}if(44===r||64===r&&125===c(l+1)){S();break}f=l,j(o);break}j();break}l++}else{if(r=C(),w(!0)&&(r=C()),f=l,t=r,40===r){l++,P();break}if(!i(t)){if(64===r&&125===c(l+1))return l+=2,void(f=l);if(123===r||91===r||46===r||44===r){S();break}j();break}l++,n=!0}}C(),f=l},S=()=>{for(;l<u;)if(w(!0));else{if(64===c(l)&&125===c(l+1)&&l>f)return a+=`let[${e.slice(f,l)}]=this;\n`,void(l+=2);l++}g()},j=t=>{for(;l<u;)if(w(!0));else{if(64===c(l)&&125===c(l+1)&&l>f)return t&&(a+=`let ${t}=`),a+=`this.import(${e.slice(f,l)})\n`,void(l+=2);l++}g()},P=t=>{f=l;let i="",s=0;for(;l<u;){const t=c(l);if(40===t)s++;else if(41===t){if(!s){i=e.slice(f,l),l++,C(),f=l;break}s--,l++}else l++}const h=a;let $=-1;for(a="";l<u;){const e=c(l);if(o(e))$=l,C();else{if(64===e&&125===c(l+1)){d($>-1?$:l);const e=a;return a=h,t&&(a+=`let ${t}=`),a+=`(${r}${n}*(${i}){${e}}.bind(this))\n`,void(l+=2)}b(e)||l++}}g()},C=()=>{let e=c(l);for(;l<u&&o(e);)l++,e=c(l);return e};for(;l<u;){const e=c(l);b(e)||l++}return d(),`return(${r}${n}*(){\n${a}}).call(this)`})(i,f);b.toString=()=>`${n} () {\n${a}\n}`;try{l||(l=Function(a),l.toString=()=>a,$&&c.cache.set(i,l,r)),f.verbose&&(console.groupCollapsed(`(${n} () {`),console.log(`${a}})\n(`,...t.reduce(((e,t)=>(e.length>0&&e.push(","),e.push(o(t)?`"${t}"`:t),e)),[]),")"),console.groupEnd());const e=(...e)=>b(...e);e[Symbol.iterator]=function*(){yield*t};for(let n=0;n<t.length;n++)e[n]=t[n];e.import=g,e.escape=p;for(const t in u)e[t]=u[t];return s(l.apply(e))}catch(e){throw e.message+=`\nat ${n} () {\n${a}\n})(${t.map((e=>o(e)?`"${e}"`:e)).join(", ")})`,e}}));return b};return c.options={},c.cache=(()=>{const i={[t]:{},[e]:{},[n]:{}};return{get:(e,t)=>i[t||n][e],set(e,s,r){i[o(s)?t:r||n][e]=s},delete(e,t){delete i[t||n][e]},clear(o){o?i[o]={}:(i[t]={},i[e]={},i[n]={})}}})(),c}));//# sourceMappingURL=nostache.min.js.map
