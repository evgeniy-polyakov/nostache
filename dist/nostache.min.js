!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e={},t=(e,t)=>(null==t?void 0:t.async)?`async ${e}`:e,n=e=>{if("function"==typeof e.next){let t="",o=()=>new Promise((t=>t(e.next()))).then((e=>e.done?t:n(e.value).then((e=>t+=e)).then(o)));return o().then((()=>t))}return new Promise((t=>t(e)))},o=(r,i)=>{if("string"==typeof r){const n=t(r,i);if(e[n])return e[n]}i=Object.assign(Object.assign({},o.options),i);const l=e=>{var t;return n(e).then(null!==(t=null==i?void 0:i.escape)&&void 0!==t?t:e=>String(e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`)))},c=(e,t)=>{var n,r;return o(null!==(r=null===(n=null==i?void 0:i.load)||void 0===n?void 0:n.call(i,e,t))&&void 0!==r?r:fetch(e,t).then((e=>e.text())))},s=(...o)=>new Promise((e=>e(r))).then((r=>{const f=t(r,i);e[f]&&e[f]!==s&&e[f](...o);const a=((e,t)=>{const n=e=>{if(e.length>1){const t={};for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=!0;return t}return e.charCodeAt(0)},o=n(" \t\r\n"),r=e=>95===e||e>=65&&e<=90||e>=97&&e<=122,i=e=>r(e)||e>=48&&e<=57,l=n("<"),c=n(">"),s=n("{"),f=n("}"),a=n("("),d=n(")"),h=n("="),u=n("~"),C=n("/"),A=n("*"),p=n("\n"),b=n("\\"),$=n("'"),y=n('"'),g=n("`"),k=n("$"),v=n("@");let m=0,x=0;const j=e.length;let w="";const P=(t=m,n="")=>{(t>x||n)&&(w+=`yield \`${e.slice(x,t)}${n}\`;\n`)},O=t=>{m>x&&(w+=t?`yield (${e.slice(x,m)});\n`:`yield this.escape(${e.slice(x,m)});\n`)},S=()=>{m>x&&(w+=`${e.slice(x,m)}`)},T=t=>{const n=e.charCodeAt(m+1);return t===l&&n===s?(P(),m+=2,E(),!0):t===s&&n===h?(P(),m+=2,q(!1),!0):t===s&&n===u?(P(),m+=2,q(!0),!0):t===s&&n===v?(P(),m+=2,B(),!0):t===b?(P(m,"\\\\"),m++,x=m,!0):t===g?(P(m,"\\`"),m++,x=m,!0):t===k&&(P(m,"\\$"),m++,x=m,!0)},E=()=>{x=m;let t=!0;for(;m<j;){if(z()){t=!1;continue}const n=e.charCodeAt(m);if(n===s){m++;const n=e.charCodeAt(m);n===c?(t=!1,S(),m++,N()):n===h||n===u?(t=!1,S(),m++,q(n===u),x--):n===v?(t=!1,m--,S(),m+=2,B()):t=!0}else if(t&&o[n])m++;else if(t&&n===l)t=!1,S(),F();else{if(n===f&&e.charCodeAt(m+1)===c){S(),m+=2;break}m++,t=!1}}x=m},F=()=>{x=m;let t=-1;for(;m<j;){const n=e.charCodeAt(m);if(n===c)m++,t=m;else if(t>=0&&o[n])m++;else{if(t>=0&&n===f){P(t);break}T(n)||(m++,t=-1)}}x=m},N=()=>{x=m;let t=-1,n=-1,r=!1;for(;m<j;){const i=e.charCodeAt(m);if(!r&&o[i])x++,m++;else if(r&&(i===l||o[i]))n<0&&(n=m),i===l&&(t=m),m++;else if(t>=0&&o[i])m++;else{if(t>=0&&i===f){P(n);break}T(i)||(m++,t=-1,n=-1),r=!0}}x=m},q=t=>{x=m;const n=t?u:h;let r=!1;for(;m<j;){if(z()){r=!0;continue}const i=e.charCodeAt(m);if(!r&&o[i])m++;else{if(i===n&&e.charCodeAt(m+1)===f){r&&O(t),m+=2;break}m++,r=!0}}x=m},z=()=>{let t=0,n=0,o=!1;for(;m<j;){const r=e.charCodeAt(m);let i=0;if(t||n||r!==$&&r!==y&&r!==g)if(t&&r===b)m+=2;else{if(t&&r===t)return t=0,m++,!0;if(t||n||r!==C||(i=e.charCodeAt(m+1))!==C&&i!==A)if(n===C&&r===p)n=0,m++;else{if(n===A&&r===A&&e.charCodeAt(m+1)===C)return n=0,m+=2,!0;if(!n&&!t)return!1;m++}else n=i,m+=2,o=!0}else t=r,m++,o=!0}return o},B=()=>{x=m;let t=0,n=!1,o="";for(;m<j;){let l=e.charCodeAt(m);if(t){if(!n||!i(l)){if(n&&!i(l)){if(o=e.slice(x,m),l=I(l),l===a){m++,H(o);break}if(l===$||l===y||l===g){x=m,m++,G(o);break}D();break}D();break}m++}else{if(l=I(l),x=m,t=l,l===a){m++,H();break}if(l===$||l===y||l===g){m++,G();break}if(!r(t)){D();break}m++,n=!0}}I(e.charCodeAt(m)),x=m},D=()=>{for(;m<j;){if(e.charCodeAt(m)===v&&e.charCodeAt(m+1)===f&&m>x){w+=`let[${e.slice(x,m)}]=this;\n`,m+=2;break}m++}},G=t=>{for(;m<j;){if(e.charCodeAt(m)===v&&e.charCodeAt(m+1)===f&&m>x){t&&(w+=`let ${t}=`),w+=`this.load(${e.slice(x,m)})\n`,m+=2;break}m++}},H=n=>{x=m;let r="",i=0;for(;m<j;){const t=e.charCodeAt(m);if(t===a)i++;else if(t===d){if(!i){r=e.slice(x,m),m++,I(e.charCodeAt(m)),x=m;break}i--,m++}else m++}const l=w;let c=-1;for(w="";m<j;){const i=e.charCodeAt(m);if(o[i])c=m,m++;else{if(i===v&&e.charCodeAt(m+1)===f){P(c>-1?c:m);const e=w;w=l,n&&(w+=`let ${n}=`),w+=`(${(null==t?void 0:t.async)?"async ":""}function*(${r}){${e}}.bind(this))\n`,m+=2;break}T(i)||m++}}},I=t=>{for(;m<j&&o[t];)m++,t=e.charCodeAt(m);return t};for(;m<j;){const t=e.charCodeAt(m);T(t)||m++}return P(),`return(${(null==t?void 0:t.async)?"async ":""}function*(){\n${w}}).call(this)`})(r,i);e[f]=s;try{(null==i?void 0:i.verbose)&&(console.groupCollapsed("(function () {"),console.log(`${a}})\n(`,...o.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const e=(...e)=>s(...e);e[Symbol.iterator]=function*(){yield*o};for(let t=0;t<o.length;t++)e[t]=o[t];return e.load=c,e.escape=l,n(Function(a).apply(e))}catch(e){throw e.message+=`\nat function () {\n${a}\n})(${o.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,e}}));return s};return o.options={},o}));//# sourceMappingURL=nostache.min.js.map
