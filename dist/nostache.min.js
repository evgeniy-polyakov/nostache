!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e=new Map,t=e=>{if(e&&"function"==typeof e.next){let n="",o=()=>new Promise((t=>t(e.next()))).then((e=>e.done?n:t(e.value).then((e=>n+=e)).then(o)));return o().then((()=>n))}return new Promise((t=>t(e)))},n=(o,i)=>{i=Object.assign(Object.assign({},n.options),i);const s=Object.assign(Object.assign({},n.options?n.options.extensions:void 0),i?i.extensions:void 0),c=e=>t(e).then("function"==typeof i.escape?i.escape:e=>null==e?"":String(e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`))),r=(e,t)=>n("function"==typeof i.load?i.load(e,t):fetch(e,t).then((e=>e.text()))),f=(...n)=>new Promise((e=>e(o))).then((o=>{const l=i.async?`async ${o}`:o;let a=e.get(l);const d=a?a.toString():((e,t)=>{const n=e=>32===e||9===e||13===e||10===e,o=e=>95===e||e>=97&&e<=122||e>=65&&e<=90,i=e=>o(e)||e>=48&&e<=57;let s=0,c=0;const r=e.length;let f="";const l=(t=s,n="")=>{(t>c||n)&&(f+=`yield \`${e.slice(c,t)}${n}\`;\n`)},a=()=>{s>c&&(f+=e.slice(c,s))},d=t=>{const n=e.charCodeAt(s+1);return 60===t&&123===n?(l(),s+=2,h(),!0):123===t&&61===n?(l(),s+=2,b(!1),!0):123===t&&126===n?(l(),s+=2,b(!0),!0):123===t&&64===n?(l(),s+=2,A(),!0):92===t?(l(s,"\\\\"),s++,c=s,!0):96===t?(l(s,"\\`"),s++,c=s,!0):36===t&&(l(s,"\\$"),s++,c=s,!0)},h=()=>{c=s;let t=!0;for(;s<r;){if(C()){t=!1;continue}const o=e.charCodeAt(s);if(123===o){s++;const n=e.charCodeAt(s);62===n?(t=!1,a(),s++,p()):61===n||126===n?(t=!1,a(),s++,b(126===n),c--):64===n?(t=!1,s--,a(),s+=2,A()):t=!0}else if(t&&n(o))s++;else if(t&&60===o)t=!1,a(),u();else{if(125===o&&62===e.charCodeAt(s+1)){a(),s+=2;break}s++,t=!1}}c=s},u=()=>{c=s;let t=-1;for(;s<r;){const o=e.charCodeAt(s);if(62===o)s++,t=s;else if(t>=0&&n(o))s++;else{if(t>=0&&125===o){l(t);break}d(o)||(s++,t=-1)}}c=s},p=()=>{c=s;let t=-1,o=-1,i=!1;for(;s<r;){const r=e.charCodeAt(s);if(!i&&n(r))c++,s++;else if(i&&(60===r||n(r)))o<0&&(o=s),60===r&&(t=s),s++;else if(t>=0&&n(r))s++;else{if(t>=0&&125===r){l(o);break}d(r)||(s++,t=-1,o=-1),i=!0}}c=s},b=t=>{c=s;const o=t?126:61;let i=!1;for(;s<r;){if(C()){i=!0;continue}const r=e.charCodeAt(s);if(!i&&n(r))s++;else{if(r===o&&125===e.charCodeAt(s+1)){i?s>c&&(f+=t?`yield (${e.slice(c,s)});\n`:`yield this.escape(${e.slice(c,s)});\n`):f+=`yield \`${e.slice(c,s)}\`;`,s+=2;break}s++,i=!0}}c=s},C=()=>{let t=0,n=0,o=!1;for(;s<r;){const i=e.charCodeAt(s);let c=0;if(t||n||39!==i&&34!==i&&96!==i)if(t&&92===i)s+=2;else{if(t&&i===t)return t=0,s++,!0;if(t||n||47!==i||47!==(c=e.charCodeAt(s+1))&&42!==c)if(47===n&&10===i)n=0,s++;else{if(42===n&&42===i&&47===e.charCodeAt(s+1))return n=0,s+=2,!0;if(!n&&!t)return!1;s++}else n=c,s+=2,o=!0}else t=i,s++,o=!0}return o},A=()=>{c=s;let t=0,n=!1,f="";for(;s<r;){let r=e.charCodeAt(s);if(t){if(!n||!i(r)){if(n&&!i(r)){if(f=e.slice(c,s),r=k(r),40===r){s++,g(f);break}if(39===r||34===r||96===r){c=s,s++,$(f);break}y();break}y();break}s++}else{if(r=k(r),c=s,t=r,40===r){s++,g();break}if(39===r||34===r||96===r){s++,$();break}if(!o(t)){y();break}s++,n=!0}}k(e.charCodeAt(s)),c=s},y=()=>{for(;s<r;){if(64===e.charCodeAt(s)&&125===e.charCodeAt(s+1)&&s>c){f+=`let[${e.slice(c,s)}]=this;\n`,s+=2;break}s++}},$=t=>{for(;s<r;){if(64===e.charCodeAt(s)&&125===e.charCodeAt(s+1)&&s>c){t&&(f+=`let ${t}=`),f+=`this.load(${e.slice(c,s)})\n`,s+=2;break}s++}},g=o=>{c=s;let i="",a=0;for(;s<r;){const t=e.charCodeAt(s);if(40===t)a++;else if(41===t){if(!a){i=e.slice(c,s),s++,k(e.charCodeAt(s)),c=s;break}a--,s++}else s++}const h=f;let u=-1;for(f="";s<r;){const c=e.charCodeAt(s);if(n(c))u=s,s++;else{if(64===c&&125===e.charCodeAt(s+1)){l(u>-1?u:s);const e=f;f=h,o&&(f+=`let ${o}=`),f+=`(${t.async?"async ":""}function*(${i}){${e}}.bind(this))\n`,s+=2;break}d(c)||s++}}},k=t=>{for(;s<r&&n(t);)s++,t=e.charCodeAt(s);return t};for(;s<r;){const t=e.charCodeAt(s);d(t)||s++}return l(),`return(${t.async?"async ":""}function*(){\n${f}}).call(this)`})(o,i);f.toString=()=>`function () {\n${d}\n}`;try{a||(a=Function(d),a.toString=()=>d,!1!==i.cache&&e.set(l,a)),i.verbose&&(console.groupCollapsed("(function () {"),console.log(`${d}})\n(`,...n.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const o=(...e)=>f(...e);o[Symbol.iterator]=function*(){yield*n};for(let e=0;e<n.length;e++)o[e]=n[e];o.load=r,o.escape=c;for(const e in s)o[e]=s[e];return t(a.apply(o))}catch(e){throw e.message+=`\nat function () {\n${d}\n})(${n.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,e}}));return f};return n.options={},n.cache=e,n}));//# sourceMappingURL=nostache.min.js.map
