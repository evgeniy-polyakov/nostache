!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e=new Map,t=e=>{if(e&&"function"==typeof e.next){let o="",n=()=>new Promise((t=>t(e.next()))).then((e=>e.done?o:t(e.value).then((e=>o+=e)).then(n)));return n().then((()=>o))}return new Promise((t=>t(e)))},o=Function("try{return this===window;}catch(e){return false;}")(),n=(i,r)=>{r=Object.assign(Object.assign({},n.options),r);const c=Object.assign(Object.assign({},n.options?n.options.extensions:void 0),r?r.extensions:void 0),s=e=>t(e).then("function"==typeof r.escape?r.escape:e=>null==e?"":String(e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`))),f=(t,i)=>(...c)=>n(new Promise((n=>{if("function"==typeof r.load)n(r.load(t,i));else{const c="string"==typeof t?t:t instanceof URL?t.toString():"",s=!1===r.cache?void 0:c?e.get(c):void 0;"string"==typeof s?n(s):(o?fetch(t,i).then((e=>e.text())):new Promise((e=>require("fs").readFile(t,"utf-8",((t,o)=>e(o)))))).then((t=>{!1!==r.cache&&e.set(c,t),n(t)}))}})),r)(...c),l=(...o)=>new Promise((e=>e(i))).then((n=>{const i=r.async?`async ${n}`:n;let a=!1===r.cache?void 0:e.get(i);const d=a?a.toString():((e,t)=>{const o=e=>32===e||9===e||13===e||10===e,n=e=>95===e||e>=97&&e<=122||e>=65&&e<=90,i=e=>n(e)||e>=48&&e<=57;let r=0,c=0;const s=e.length;let f="";const l=(t=r,o="")=>{(t>c||o)&&(f+=`yield \`${e.slice(c,t)}${o}\`;\n`)},a=t=>{r>c&&(f+=t?`yield (${e.slice(c,r)});\n`:`yield this.escape(${e.slice(c,r)});\n`)},d=()=>{r>c&&(f+=e.slice(c,r))},h=t=>{throw new SyntaxError(`Expected end of ${t} at\n${e}`)},u=t=>{const o=e.charCodeAt(r+1);return 60===t&&123===o?(l(),r+=2,p(),!0):123===t&&61===o?(l(),r+=2,y(!1),!0):123===t&&126===o?(l(),r+=2,y(!0),!0):123===t&&64===o?(l(),r+=2,$(),!0):92===t?(l(r,"\\\\"),r++,c=r,!0):96===t?(l(r,"\\`"),r++,c=r,!0):36===t&&(l(r,"\\$"),r++,c=r,!0)},p=()=>{c=r;let t=!1;for(;r<s;){if(A())continue;const n=e.charCodeAt(r);if(123===n){r++;const o=e.charCodeAt(r);62===o?(t=!1,d(),r++,g()):61===o||126===o?(t=!1,d(),r++,y(126===o),c--):64===o?(t=!1,r--,d(),r+=2,$()):t=!0}else if(t&&o(n))r++;else if(t&&60===n)t=!1,d(),C();else{if(125===n&&62===e.charCodeAt(r+1))return d(),r+=2,void(c=r);r++,t=!1}}h("logic block }>")},C=()=>{c=r;let t=-1;for(;r<s;){const n=e.charCodeAt(r);if(62===n)r++,t=r;else if(t>=0&&o(n))r++;else if(t>=0&&A(!0));else{if(t>=0&&125===n)return l(t),void(c=r);u(n)||(r++,t=-1)}}h("html block >}")},g=()=>{c=r;let t=-1,n=-1,i=!1;for(;r<s;){const s=e.charCodeAt(r);if(!i&&o(s))c++,r++;else if(u(s))i=!0,t=-1,n=-1;else if(60===s||o(s))n<0&&(n=r),60===s&&(t=r),r++;else if(t>=0&&o(s))r++;else{if(t>=0&&125===s)return i&&l(n),void(c=r);r++,t=-1,n=-1,i=!0}}h("text block <}")},y=t=>{c=r;const n=t?126:61;let i=!1,l=!1;for(;r<s;){const s=A();if(1===s){i=!0;continue}2!==s||i||(l=!0,c=r);const d=e.charCodeAt(r);if(!i&&o(d))r++;else{if(d===n&&125===e.charCodeAt(r+1))return i?a(t):l||(f+=`yield \`${e.slice(c,r)}\`;`),r+=2,void(c=r);r++,i=!0}}h("output block "+(t?"~}":"=}"))},A=(t=!1)=>{let o=0,n=0,i=0;for(;r<s;){const c=e.charCodeAt(r);let s=0;if(t||o||n||39!==c&&34!==c&&96!==c)if(o&&92===c)r+=2;else{if(o&&c===o)return r++,1;if(o||n||47!==c||47!==(s=e.charCodeAt(r+1))&&42!==s){if(47===n&&10===c)return r++,2;if(42===n&&42===c&&47===e.charCodeAt(r+1))return r+=2,2;if(!n&&!o)return 0;r++}else n=s,r+=2,i=2}else o=c,r++,i=1}return i&&o&&h(`string ${String.fromCharCode(o)}`),i&&42===n&&h("comment */"),i},$=()=>{c=r;let t=0,o=!1,f="";for(;r<s;){let s=e.charCodeAt(r);if(t){if(!o||!i(s)){if(o&&!i(s)){if(f=e.slice(c,r),s=v(s),A(!0)&&(s=v(e.charCodeAt(r))),40===s){r++,m(f);break}if(39===s||34===s||96===s){c=r,r++,k(f);break}b();break}b();break}r++}else{if(s=v(s),A(!0)&&(s=v(e.charCodeAt(r))),c=r,t=s,40===s){r++,m();break}if(39===s||34===s||96===s){r++,k();break}if(!n(t)){if(64===s&&125===e.charCodeAt(r+1))return r+=2,void(c=r);b();break}r++,o=!0}}v(e.charCodeAt(r)),c=r},b=()=>{for(;r<s;)if(A(!0));else{if(64===e.charCodeAt(r)&&125===e.charCodeAt(r+1)&&r>c)return f+=`let[${e.slice(c,r)}]=this;\n`,void(r+=2);r++}h("declaration block @}")},k=t=>{for(;r<s;)if(A(!0));else{if(64===e.charCodeAt(r)&&125===e.charCodeAt(r+1)&&r>c)return t&&(f+=`let ${t}=`),f+=`this.load(${e.slice(c,r)})\n`,void(r+=2);r++}h("declaration block @}")},m=n=>{c=r;let i="",a=0;for(;r<s;){const t=e.charCodeAt(r);if(40===t)a++;else if(41===t){if(!a){i=e.slice(c,r),r++,v(e.charCodeAt(r)),c=r;break}a--,r++}else r++}const d=f;let p=-1;for(f="";r<s;){const c=e.charCodeAt(r);if(o(c))p=r,v(c);else{if(64===c&&125===e.charCodeAt(r+1)){l(p>-1?p:r);const e=f;return f=d,n&&(f+=`let ${n}=`),f+=`(${t.async?"async ":""}function*(${i}){${e}}.bind(this))\n`,void(r+=2)}u(c)||r++}}h("declaration block @}")},v=t=>{for(;r<s&&o(t);)r++,t=e.charCodeAt(r);return t};for(;r<s;){const t=e.charCodeAt(r);u(t)||r++}return l(),`return(${t.async?"async ":""}function*(){\n${f}}).call(this)`})(n,r);l.toString=()=>`function () {\n${d}\n}`;try{a&&"string"!=typeof a||(a=Function(d),a.toString=()=>d,!1!==r.cache&&e.set(i,a)),r.verbose&&(console.groupCollapsed("(function () {"),console.log(`${d}})\n(`,...o.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const n=(...e)=>l(...e);n[Symbol.iterator]=function*(){yield*o};for(let e=0;e<o.length;e++)n[e]=o[e];n.load=f,n.escape=s;for(const e in c)n[e]=c[e];return t(a.apply(n))}catch(e){throw e.message+=`\nat function () {\n${d}\n})(${o.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,e}}));return l};return n.options={},n.cache=e,n}));//# sourceMappingURL=nostache.min.js.map
