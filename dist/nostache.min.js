!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e={},t=async e=>String(await e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`)),o=async e=>{let t="";for(;;){const r=await e.next();if(r.done)break;"function"==typeof r.value?.next?t+=await o(r.value):t+=await r.value}return t},r=n=>{if(e[n])return e[n];const c=(e=>{const t=e=>{if(e.length>1){const t={};for(let o=0;o<e.length;o++)t[e.charCodeAt(o)]=!0;return t}return e.charCodeAt(0)},o=t(" \t\r\n"),r=e=>95===e||e>=65&&e<=90||e>=97&&e<=122,n=e=>r(e)||e>=48&&e<=57,c=t("<"),i=t(">"),s=t("{"),l=t("}"),a=t("(");t(")");const f=t("="),d=t("~"),h=t("/"),u=t("*"),p=t("\n"),C=t("\\"),A=t("'"),b=t('"'),y=t("`"),$=t("$"),g=t("@");let k=0,m=0;const v=e.length;let w="";const H=(t=k,o="")=>{(t>m||o)&&(w+=`yield \`${e.slice(m,t)}${o}\`;\n`)},x=t=>{k>m&&(w+=t?`yield (${e.slice(m,k)});\n`:`yield this.escapeHtml(${e.slice(m,k)});\n`)},S=()=>{k>m&&(w+=`${e.slice(m,k)}`)},j=t=>{const o=e.charCodeAt(k+1);return t===c&&o===s?(H(),k+=2,T(),!0):t===s&&o===f?(H(),k+=2,N(!1),!0):t===s&&o===d?(H(),k+=2,N(!0),!0):t===s&&o===g?(H(),k+=2,z(),!0):t===C?(H(k,"\\\\"),k++,m=k,!0):t===y?(H(k,"\\`"),k++,m=k,!0):t===$&&(H(k,"\\$"),k++,m=k,!0)},T=()=>{m=k;let t=!0;for(;k<v;){if(q()){t=!1;continue}const r=e.charCodeAt(k);if(r===s){k++;const o=e.charCodeAt(k);o===i?(t=!1,S(),k++,F()):o===f||o===d?(t=!1,S(),k++,N(o===d),m--):o===g?(t=!1,k--,S(),k+=2,z()):t=!0}else if(t&&o[r])k++;else if(t&&r===c)t=!1,S(),E();else{if(r===l&&e.charCodeAt(k+1)===i){S(),k+=2;break}k++,t=!1}}m=k},E=()=>{m=k;let t=-1;for(;k<v;){const r=e.charCodeAt(k);if(r===i)k++,t=k;else if(t>=0&&o[r])k++;else{if(t>=0&&r===l){H(t);break}j(r)||(k++,t=-1)}}m=k},F=()=>{m=k;let t=-1,r=-1,n=!1;for(;k<v;){const i=e.charCodeAt(k);if(!n&&o[i])m++,k++;else if(n&&(i===c||o[i]))r<0&&(r=k),i===c&&(t=k),k++;else if(t>=0&&o[i])k++;else{if(t>=0&&i===l){H(r);break}j(i)||(k++,t=-1,r=-1),n=!0}}m=k},N=t=>{m=k;const r=t?d:f;let n=!1;for(;k<v;){if(q()){n=!0;continue}const c=e.charCodeAt(k);if(!n&&o[c])k++;else{if(c===r&&e.charCodeAt(k+1)===l){n&&x(t),k+=2;break}k++,n=!0}}m=k},q=()=>{let t=0,o=0,r=!1;for(;k<v;){const n=e.charCodeAt(k);let c=0;if(t||o||n!==A&&n!==b&&n!==y)if(t&&n===C)k+=2;else{if(t&&n===t)return t=0,k++,!0;if(t||o||n!==h||(c=e.charCodeAt(k+1))!==h&&c!==u)if(o===h&&n===p)o=0,k++;else{if(o===u&&n===u&&e.charCodeAt(k+1)===h)return o=0,k+=2,!0;if(!o&&!t)return!1;k++}else o=c,k+=2,r=!0}else t=n,k++,r=!0}return r},z=()=>{m=k;let t=0,o=!1,c="";for(;k<v;){let i=e.charCodeAt(k);if(t){if(!o||!n(i)){if(o&&!n(i)){if(c=e.slice(m,k),i=G(i),i===a){k++,m=k;break}if(i===A||i===b||i===y){m=k,D(c);break}B();break}B();break}k++}else{if(i=G(i),m=k,t=i,i===a){k++;break}if(i===A||i===b||i===y){D();break}if(!r(t)){B();break}k++,o=!0}}G(e.charCodeAt(k)),m=k},B=()=>{for(;k<v;){if(e.charCodeAt(k)===g&&e.charCodeAt(k+1)===l&&k>m){w+=`let[${e.slice(m,k)}]=this;\n`,k+=2;break}k++}},D=t=>{for(;k<v;)e.charCodeAt(k)===g&&e.charCodeAt(k+1)===l&&k>m?(t&&(w+=`${t}=`),w+=`this.load(${e.slice(m,k)});\n`,k+=2):k++},G=t=>{for(;k<v&&o[t];)k++,t=e.charCodeAt(k);return t};for(;k<v;){const t=e.charCodeAt(k);j(t)||k++}return H(),`return(async function*(){\n${w}}).call(this)`})(n),i=async(...e)=>{try{i.verbose&&(console.groupCollapsed("(function () {"),console.log(`${c}})\n(`,...e.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const t=(...e)=>i(...e);t[Symbol.iterator]=function*(){yield*e};for(let o=0;o<e.length;o++)t[o]=e[o];t.escapeHtml=i.escapeHtml;const r=Function(c).apply(t);return o(r)}catch(t){throw t.message+=`\nat function () {\n${c}\n})(${e.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,t}};return i.verbose=r.verbose,i.escapeHtml=t,i.toString=()=>c,e[n]=i,i};return r.verbose=!1,r.escapeHtml=t,r}));//# sourceMappingURL=nostache.min.js.map
