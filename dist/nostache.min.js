!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e=new Map,t=e=>{if(e&&"function"==typeof e.next){let o="",n=()=>new Promise((t=>t(e.next()))).then((e=>e.done?o:t(e.value).then((e=>o+=e)).then(n)));return n().then((()=>o))}return new Promise((t=>t(e)))},o=Function("try{return this===window;}catch(e){return false;}")(),n=(r,i)=>{i=Object.assign(Object.assign({},n.options),i);const c=Object.assign(Object.assign({},n.options?n.options.extensions:void 0),i?i.extensions:void 0),s=e=>t(e).then("function"==typeof i.escape?i.escape:e=>null==e?"":String(e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`))),f=t=>(...r)=>n(new Promise(((n,r)=>{if("function"==typeof i.import)n(i.import(t));else{const c=!1===i.cache?void 0:e.get(t);if("string"==typeof c)n(c);else{const c=o=>{!1!==i.cache&&e.set(t,o),n(o)};try{o?fetch(t).then((e=>200===e.status?e.text().then(c):r(new Error(`${e.status} ${e.url}`)))):require("fs").readFile(t,"utf8",((e,t)=>e?r(e):c(t)))}catch(e){r(e)}}}})),i)(...r),l=(...o)=>new Promise((e=>e(r))).then((n=>{const r=i.async?`async ${n}`:n;let a=!1===i.cache?void 0:e.get(r);const d=a?a.toString():((e,t)=>{const o=e=>32===e||9===e||13===e||10===e,n=e=>95===e||e>=97&&e<=122||e>=65&&e<=90,r=e=>n(e)||e>=48&&e<=57;let i=0,c=0;const s=e.length;let f="";const l=(t=i,o="")=>{(t>c||o)&&(f+=`yield \`${e.slice(c,t)}${o}\`;\n`)},a=t=>{i>c&&(f+=t?`yield (${e.slice(c,i)});\n`:`yield this.escape(${e.slice(c,i)});\n`)},d=()=>{i>c&&(f+=e.slice(c,i))},h=t=>{throw new SyntaxError(`Expected end of ${t} at\n${e}`)},u=t=>{const o=e.charCodeAt(i+1);return 60===t&&123===o?(l(),i+=2,p(),!0):123===t&&61===o?(l(),i+=2,$(!1),!0):123===t&&126===o?(l(),i+=2,$(!0),!0):123===t&&64===o?(l(),i+=2,A(),!0):92===t?(l(i,"\\\\"),i++,c=i,!0):96===t?(l(i,"\\`"),i++,c=i,!0):36===t&&(l(i,"\\$"),i++,c=i,!0)},p=()=>{c=i;let t=!1;for(;i<s;){if(g())continue;const n=e.charCodeAt(i);if(123===n){i++;const o=e.charCodeAt(i);62===o?(t=!1,d(),i++,y()):61===o||126===o?(t=!1,d(),i++,$(126===o),c--):64===o?(t=!1,i--,d(),i+=2,A()):t=!0}else if(t&&o(n))i++;else if(t&&60===n)t=!1,d(),C();else{if(125===n&&62===e.charCodeAt(i+1))return d(),i+=2,void(c=i);i++,t=!1}}h("logic block }>")},C=()=>{c=i;let t=-1;for(;i<s;){const n=e.charCodeAt(i);if(62===n)i++,t=i;else if(t>=0&&o(n))i++;else if(t>=0&&g(!0));else{if(t>=0&&125===n)return l(t),void(c=i);u(n)||(i++,t=-1)}}h("html block >}")},y=()=>{c=i;let t=-1,n=-1,r=!1;for(;i<s;){const s=e.charCodeAt(i);if(!r&&o(s))c++,i++;else if(u(s))r=!0,t=-1,n=-1;else if(60===s||o(s))n<0&&(n=i),60===s&&(t=i),i++;else if(t>=0&&o(s))i++;else{if(t>=0&&125===s)return r&&l(n),void(c=i);i++,t=-1,n=-1,r=!0}}h("text block <}")},$=t=>{c=i;const n=t?126:61;let r=!1,l=!1;for(;i<s;){const s=g();if(1===s){r=!0;continue}2!==s||r||(l=!0,c=i);const d=e.charCodeAt(i);if(!r&&o(d))i++;else{if(d===n&&125===e.charCodeAt(i+1))return r?a(t):l||(f+=`yield \`${e.slice(c,i)}\`;`),i+=2,void(c=i);i++,r=!0}}h("output block "+(t?"~}":"=}"))},g=(t=!1)=>{let o=0,n=0,r=0;for(;i<s;){const c=e.charCodeAt(i);let s=0;if(t||o||n||39!==c&&34!==c&&96!==c)if(o&&92===c)i+=2;else{if(o&&c===o)return i++,1;if(o||n||47!==c||47!==(s=e.charCodeAt(i+1))&&42!==s){if(47===n&&10===c)return i++,2;if(42===n&&42===c&&47===e.charCodeAt(i+1))return i+=2,2;if(!n&&!o)return 0;i++}else n=s,i+=2,r=2}else o=c,i++,r=1}return r&&o&&h(`string ${String.fromCharCode(o)}`),r&&42===n&&h("comment */"),r},A=()=>{c=i;let t=0,o=!1,f="";for(;i<s;){let s=e.charCodeAt(i);if(t){if(!o||!r(s)){if(o&&!r(s)){if(f=e.slice(c,i),s=v(s),g(!0)&&(s=v(e.charCodeAt(i))),40===s){i++,k(f);break}if(39===s||34===s||96===s){c=i,i++,m(f);break}b();break}b();break}i++}else{if(s=v(s),g(!0)&&(s=v(e.charCodeAt(i))),c=i,t=s,40===s){i++,k();break}if(39===s||34===s||96===s){i++,m();break}if(!n(t)){if(64===s&&125===e.charCodeAt(i+1))return i+=2,void(c=i);b();break}i++,o=!0}}v(e.charCodeAt(i)),c=i},b=()=>{for(;i<s;)if(g(!0));else{if(64===e.charCodeAt(i)&&125===e.charCodeAt(i+1)&&i>c)return f+=`let[${e.slice(c,i)}]=this;\n`,void(i+=2);i++}h("declaration block @}")},m=t=>{for(;i<s;)if(g(!0));else{if(64===e.charCodeAt(i)&&125===e.charCodeAt(i+1)&&i>c)return t&&(f+=`let ${t}=`),f+=`this.import(${e.slice(c,i)})\n`,void(i+=2);i++}h("declaration block @}")},k=n=>{c=i;let r="",a=0;for(;i<s;){const t=e.charCodeAt(i);if(40===t)a++;else if(41===t){if(!a){r=e.slice(c,i),i++,v(e.charCodeAt(i)),c=i;break}a--,i++}else i++}const d=f;let p=-1;for(f="";i<s;){const c=e.charCodeAt(i);if(o(c))p=i,v(c);else{if(64===c&&125===e.charCodeAt(i+1)){l(p>-1?p:i);const e=f;return f=d,n&&(f+=`let ${n}=`),f+=`(${t.async?"async ":""}function*(${r}){${e}}.bind(this))\n`,void(i+=2)}u(c)||i++}}h("declaration block @}")},v=t=>{for(;i<s&&o(t);)i++,t=e.charCodeAt(i);return t};for(;i<s;){const t=e.charCodeAt(i);u(t)||i++}return l(),`return(${t.async?"async ":""}function*(){\n${f}}).call(this)`})(n,i);l.toString=()=>`function () {\n${d}\n}`;try{a&&"string"!=typeof a||(a=Function(d),a.toString=()=>d,!1!==i.cache&&e.set(r,a)),i.verbose&&(console.groupCollapsed("(function () {"),console.log(`${d}})\n(`,...o.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const n=(...e)=>l(...e);n[Symbol.iterator]=function*(){yield*o};for(let e=0;e<o.length;e++)n[e]=o[e];n.import=f,n.escape=s;for(const e in c)n[e]=c[e];return t(a.apply(n))}catch(e){throw e.message+=`\nat function () {\n${d}\n})(${o.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,e}}));return l};return n.options={},n.cache=e,n}));//# sourceMappingURL=nostache.min.js.map
