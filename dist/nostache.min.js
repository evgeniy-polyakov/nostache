!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Nostache=t()}(this,(function(){"use strict";const e=new Map,t=e=>{if(e&&"function"==typeof e.next){let n="",o=()=>new Promise((t=>t(e.next()))).then((e=>e.done?n:t(e.value).then((e=>n+=e)).then(o)));return o().then((()=>n))}return new Promise((t=>t(e)))},n=(o,i)=>{i=Object.assign(Object.assign({},n.options),i);const s=Object.assign(Object.assign({},n.options?n.options.extensions:void 0),i?i.extensions:void 0),r=e=>t(e).then("function"==typeof i.escape?i.escape:e=>null==e?"":String(e).replace(/[&<>"']/g,(e=>`&#${e.charCodeAt(0)};`))),c=(t,o)=>(...s)=>{const r="string"==typeof t?t:t instanceof URL?t.toString():"";let c=r?e.get(r):void 0;return c&&"string"!=typeof c&&(c=void 0),n(new Promise((e=>e(c||("function"==typeof i.load?i.load(t,o):fetch(t,o).then((e=>e.text())))))).then((t=>(c||!1===i.cache||e.set(r,t),t))),i)(...s)},f=(...n)=>new Promise((e=>e(o))).then((o=>{const l=i.async?`async ${o}`:o;let a=e.get(l);const d=a?a.toString():((e,t)=>{const n=e=>32===e||9===e||13===e||10===e,o=e=>95===e||e>=97&&e<=122||e>=65&&e<=90,i=e=>o(e)||e>=48&&e<=57;let s=0,r=0;const c=e.length;let f="";const l=(t=s,n="")=>{(t>r||n)&&(f+=`yield \`${e.slice(r,t)}${n}\`;\n`)},a=()=>{s>r&&(f+=e.slice(r,s))},d=t=>{const n=e.charCodeAt(s+1);return 60===t&&123===n?(l(),s+=2,h(),!0):123===t&&61===n?(l(),s+=2,g(!1),!0):123===t&&126===n?(l(),s+=2,g(!0),!0):123===t&&64===n?(l(),s+=2,b(),!0):92===t?(l(s,"\\\\"),s++,r=s,!0):96===t?(l(s,"\\`"),s++,r=s,!0):36===t&&(l(s,"\\$"),s++,r=s,!0)},h=()=>{r=s;let t=!0;for(;s<c;){if(y()){t=!1;continue}const o=e.charCodeAt(s);if(123===o){s++;const n=e.charCodeAt(s);62===n?(t=!1,a(),s++,p()):61===n||126===n?(t=!1,a(),s++,g(126===n),r--):64===n?(t=!1,s--,a(),s+=2,b()):t=!0}else if(t&&n(o))s++;else if(t&&60===o)t=!1,a(),u();else{if(125===o&&62===e.charCodeAt(s+1)){a(),s+=2;break}s++,t=!1}}r=s},u=()=>{r=s;let t=-1;for(;s<c;){const o=e.charCodeAt(s);if(62===o)s++,t=s;else if(t>=0&&n(o))s++;else{if(t>=0&&125===o){l(t);break}d(o)||(s++,t=-1)}}r=s},p=()=>{r=s;let t=-1,o=-1,i=!1;for(;s<c;){const c=e.charCodeAt(s);if(!i&&n(c))r++,s++;else if(i&&(60===c||n(c)))o<0&&(o=s),60===c&&(t=s),s++;else if(t>=0&&n(c))s++;else{if(t>=0&&125===c){l(o);break}d(c)||(s++,t=-1,o=-1),i=!0}}r=s},g=t=>{r=s;const o=t?126:61;let i=!1;for(;s<c;){if(y()){i=!0;continue}const c=e.charCodeAt(s);if(!i&&n(c))s++;else{if(c===o&&125===e.charCodeAt(s+1)){i?s>r&&(f+=t?`yield (${e.slice(r,s)});\n`:`yield this.escape(${e.slice(r,s)});\n`):f+=`yield \`${e.slice(r,s)}\`;`,s+=2;break}s++,i=!0}}r=s},y=()=>{let t=0,n=0,o=!1;for(;s<c;){const i=e.charCodeAt(s);let r=0;if(t||n||39!==i&&34!==i&&96!==i)if(t&&92===i)s+=2;else{if(t&&i===t)return t=0,s++,!0;if(t||n||47!==i||47!==(r=e.charCodeAt(s+1))&&42!==r)if(47===n&&10===i)n=0,s++;else{if(42===n&&42===i&&47===e.charCodeAt(s+1))return n=0,s+=2,!0;if(!n&&!t)return!1;s++}else n=r,s+=2,o=!0}else t=i,s++,o=!0}return o},b=()=>{r=s;let t=0,n=!1,f="";for(;s<c;){let c=e.charCodeAt(s);if(t){if(!n||!i(c)){if(n&&!i(c)){if(f=e.slice(r,s),c=k(c),40===c){s++,$(f);break}if(39===c||34===c||96===c){r=s,s++,A(f);break}C();break}C();break}s++}else{if(c=k(c),r=s,t=c,40===c){s++,$();break}if(39===c||34===c||96===c){s++,A();break}if(!o(t)){C();break}s++,n=!0}}k(e.charCodeAt(s)),r=s},C=()=>{for(;s<c;){if(64===e.charCodeAt(s)&&125===e.charCodeAt(s+1)&&s>r){f+=`let[${e.slice(r,s)}]=this;\n`,s+=2;break}s++}},A=t=>{for(;s<c;){if(64===e.charCodeAt(s)&&125===e.charCodeAt(s+1)&&s>r){t&&(f+=`let ${t}=`),f+=`this.load(${e.slice(r,s)})\n`,s+=2;break}s++}},$=o=>{r=s;let i="",a=0;for(;s<c;){const t=e.charCodeAt(s);if(40===t)a++;else if(41===t){if(!a){i=e.slice(r,s),s++,k(e.charCodeAt(s)),r=s;break}a--,s++}else s++}const h=f;let u=-1;for(f="";s<c;){const r=e.charCodeAt(s);if(n(r))u=s,s++;else{if(64===r&&125===e.charCodeAt(s+1)){l(u>-1?u:s);const e=f;f=h,o&&(f+=`let ${o}=`),f+=`(${t.async?"async ":""}function*(${i}){${e}}.bind(this))\n`,s+=2;break}d(r)||s++}}},k=t=>{for(;s<c&&n(t);)s++,t=e.charCodeAt(s);return t};for(;s<c;){const t=e.charCodeAt(s);d(t)||s++}return l(),`return(${t.async?"async ":""}function*(){\n${f}}).call(this)`})(o,i);f.toString=()=>`function () {\n${d}\n}`;try{a&&"string"!=typeof a||(a=Function(d),a.toString=()=>d,!1!==i.cache&&e.set(l,a)),i.verbose&&(console.groupCollapsed("(function () {"),console.log(`${d}})\n(`,...n.reduce(((e,t)=>(e.length>0&&e.push(","),e.push("string"==typeof t?`"${t}"`:t),e)),[]),")"),console.groupEnd());const o=(...e)=>f(...e);o[Symbol.iterator]=function*(){yield*n};for(let e=0;e<n.length;e++)o[e]=n[e];o.load=c,o.escape=r;for(const e in s)o[e]=s[e];return t(a.apply(o))}catch(e){throw e.message+=`\nat function () {\n${d}\n})(${n.map((e=>"string"==typeof e?`"${e}"`:e)).join(", ")})`,e}}));return f};return n.options={},n.cache=e,n}));//# sourceMappingURL=nostache.min.js.map
